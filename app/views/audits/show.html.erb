<hr>
<h3>Findings</h3>

<div class="mb-3">
  <%= link_to "Add Finding", new_audit_finding_path(@audit), class: "btn btn-sm btn-primary" %>
</div>

<table class="table table-bordered">
  <thead>
    <tr>
      <th>Title</th>
      <th>Severity</th>
      <th>Status</th>
      <th>Due On</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @audit.findings.each do |finding| %>
      <tr>
        <td><%= link_to finding.title, [@audit, finding] %></td>
        <td>
          <% sev_class = case finding.severity
            when "low" then "bg-success"
            when "medium" then "bg-warning"
            when "high" then "bg-danger"
            when "critical" then "bg-dark"
          end %>
          <span class="badge <%= sev_class %>"><%= finding.severity.humanize %></span>
        </td>
        <td><%= finding.status.humanize %></td>
        <td><%= finding.due_on&.strftime("%b %d, %Y") %></td>
        <td><%= link_to "Edit", edit_audit_finding_path(@audit, finding), class: "btn btn-sm btn-outline-secondary" %></td>
      </tr>
    <% end %>
  </tbody>
</table>


